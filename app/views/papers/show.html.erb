<%= render partial: "nav2" %>
<div class="content">

<div class="item">

  <div class="show">
    <% if @paper.image.url %>
      <%= image_tag @paper.image.url, style: "width:100%;"%>
    <% else %>
      <%= image_tag "https://www.obayashi.co.jp/tri/facilities/img/photo01.jpg", style: "width:100%;"%>
    <% end %>

    <div class="clearfix">
      <div class="title-box">
        <% if @paper.headline %>
          <h2> <%= @paper.headline %> </h2>
        <% else %>
          <h2> <%= @paper.title %> </h2>
        <% end %>
      </div>
      <div class="picks-box">
        <div class="curled-box"> <span class="num"><%= @paper.comments_count%></span> <br> Picks </div>
      </div>
    </div>
    <div class="source"><%= link_to "Ë´ñÊñá„ÇíË™≠„ÇÄ", "#{@paper.url}"%></div>
  </div>

<div id="modal-content" class="clearfix"></div>
<% if not @comments[0] %>
  <div class="abstract"><%= simple_format @paper.abstract %></div>
<% end %>

  <div class="picks">
    <% if  @comments[0] %>
      <div class="section-header">„Ç≥„É°„É≥„Éà</div>
    <% end %>
    <% @comments.each do |comment| %>
        <%= render partial: "commentbox", locals: {comment: comment} %>
    <% end %>
  </div>

  <div class="pick">
    <% if user_signed_in? %>
      <% if @paper.comment_user(current_user.id) %>
        <%= link_to 'üçÅPick„ÇíÁ∑®ÈõÜüçÅ', "/papers/#{@paper.id}/comments/#{@paper.comment_user(current_user.id).id}/edit",  remote: true %>
        <span style="color:white">......</span>
        <%= link_to 'üî•Pick„ÇíÂâäÈô§üî•', "/papers/#{@paper.id}/comments/#{@paper.comment_user(current_user.id).id}", method: :delete %>
      <% else %>
        <%= link_to 'üçÄPick„Åô„ÇãüçÄ', "/papers/#{@paper.id}/comments/new",  remote:true %>
      <% end %>
      <script>
      $(document).ready(function(){

        
        

        $('.pick').css('width' , $('.item').outerWidth() );

        var sc_previous = $(document).scrollTop();
        $(document).scroll(function () {
          var sc_now = $(document).scrollTop();
          if (sc_previous - sc_now < 1){
            $(".pick").fadeOut("fast");
            sc_previous = sc_now;
          }else{
            $(".pick").fadeIn("fast");
          }
        });
      });
      </script>
    <% end %>
  </div>

</div>
</div>

<script>
// History API „Åå‰Ωø„Åà„Çã„Éñ„É©„Ç¶„Ç∂„Åã„Å©„ÅÜ„Åã„Çí„ÉÅ„Çß„ÉÉ„ÇØ
if( window.history && window.history.pushState ){
  //. „Éñ„É©„Ç¶„Ç∂Â±•Ê≠¥„Å´Ôºë„Å§ËøΩÂä†
  history.pushState( "nohb", null, "" );
  $(window).on( "popstate", function(event){
    //. „Åì„ÅÆ„Éö„Éº„Ç∏„Åß„ÄåÊàª„Çã„Äç„ÇíÂÆüË°å
    if( !event.originalEvent.state ){
      //. „ÇÇ„ÅÜ‰∏ÄÂ∫¶Â±•Ê≠¥„ÇíÊìç‰Ωú„Åó„Å¶ÁµÇ‰∫Ü
      history.pushState( "nohb", null, "" );
      return;
    }
  });
}
</script>


